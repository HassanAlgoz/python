---
title: التحكم في سير الأوامر
jupyter: python3
---

بايثون تنفذ الأوامر البرمجية بحسب ترتيبها من الأعلى للأسفل. فإذا كتبنا الكود التالي:

```{python}
x = 1
x = 2
print(x)
```

فالتعيين اللاحق ناسخٌ (ماحٍ) لما قبله.

الأصل في تنفيذ الأوامر البرمجية أن يكون بالترتيب من أوَّل سطر نزولاً إلى آخر سطر برمجي. لكن هناك حالات تستدعي تغيير هذا الترتيب:

1. **التنفيذ المشروط**: تعليق تنفيذ قطعة كود على حصول حالة (أو أحوال) معيَّنة
2. **حلقة التكرار**: الرجوع لسطر سابق إلى حين حصول الغرض من هذه الحلقة
3. **الانتقال من وإلى نطاق عملية**: ويتحقق هذا بنداء عمليَّة مُعرَّفة (وهي قطعة كود لها اسم) وقد سبق لنا استمعالها: (`print`, `len`, ...etc). وسيأتي الحديث عنها في الدرس القادم.
4. **حدوث خطأ**: التعامل مع حالات الخطأ المتوقعة

## التعبير المنطقي

أما الشروط فتستند إلى المنطق الرقمي الثنائي الذي نجد له في بايثون كلمتين من أصل اللغة هما: `True` (تساوي الرقم `1`) وتعبِّر عن تحقق الأمر، وكلمة: `False` (تساوي الرقم `0`) وتعبِّر عن عدم التحقق. وكلاهُما شيء من الصنف: **ثنائي**.

التعبيرات المنطقية هي تعبيرات تؤول إما إلى `True` أو `False`. ولذا فإن منها جُمل المقارنة:

| العلامة | الوصف |
| --- | --- |
| `a == b` | يساوي |
| `a != b` | لا يساوي |
| `a > b` | أكبر من |
| `a < b` | أصغر من |
| `a >= b` | أكبر من أو يساوي |
| `a <= b` | أصغر من أو يساوي |

لنستكشف سويًّا التعبيرات المنطقية وما يمكن بينها:

```{python}
b1 = 5 > 9
print(b1)
```

```{python}
b2 = len('12345') > len('123456789')
print(b2)
```

يمكن دمج التعبيرات المنطقية باستخدام العوامل `and`، `or`، و `not`:

| A | B | AND | OR  | XOR |
|----------|----------|----------|---------|------------------|
|     0    |     0    |    0     |    0    |        0        |
|     0    |     1    |    0     |    1    |        1        |
|     1    |     0    |    0     |    1    |        1        |
|     1    |     1    |    1     |    1    |        0        |

- AND (و): تُعطي النتيجة 1 فقط إذا كان كلا المدخلين 1.
- OR (أو): تُعطي النتيجة 1 إذا كان أحد المدخلين على الأقل 1.
- XOR (أو الحصرية): تُعطي النتيجة 1 إذا كان المدخلان مختلفين.
- NOT (ليس): يعكس المدخل (1 يصبح 0، و0 يصبح 1).

```{python}
b3 = b1 and b2
print(b3)
```

```{python}
b4 = b1 or b2 or b3
print(b4)
```

```{python}
b5 = not b1
print(b5)
```


## جملة التوكيد

تُدرَج جُملَ التوكيد في ثنايا الكود للتحقق من صحَّة التسلسل المنطقي. فالتوكيد يُحدثُ خطأ إذا كانت القيمة التي نؤكدها خاطئة. مثلاً:

```{python}
#| error: true
assert False
```

كما تُسحتب الكتابة بلغة البشر لما يجب أن يكون ، بعد الفاصلة، هكذا ، لتظهر في رسالة الخطأ واضحة:

```{python}
#| error: true
x = 10
y = 20
assert x > y, 'x should be greater than y'
```

أما إذا كانت العبارة صحيحة فلا خطأ:

```{python}
assert True
```

```{python}
x = 2 ** 4
y = pow(2, 4)
assert x == x, 'x should be equal to x'
```

هذه الجُمَل البسيطة تساعد في اختبار الكود وكشف الأخطاء في وقتٍ مبكِّر ، كما أنها تساعد في التعلُّم (الآن عرفت أن `**` هي عملية الأس `pow`) كما سنستخدمها الآن لأنها تحقق ما نحن بصدد التحقق منه. وهي تغنينا عن كثيرٍ من جُمَل `print()`.

## الجملة الشرطية

تُستخدم العبارات الشرطية لتنفيذ أجزاء مختلفة من الكود بناءً على قيمة تعبير منطقي. مثال:

```{python}
if b5:
    print('Inside')
print('Outside')
```

### المحاذاة العمودية (Indentation)

لاحظ أن **المحاذاة العمودية** (المسافات البيضاء أسفل كلمة `if`) في الكود أعلاه ليست لمجرد تسهيل قراءة الكود، بل هي التي تحدد التعليمات المشروطة. عادةً ما تكون المحاذاة عبارة عن 4 مسافات أو 2 أو أكثر، لكن لابد أن تكون موحَّدة طوال الكود.

لاحظ: بدون المحاذاة الصحيحة، سيظهر خطأ في الكود:

```{python}
#| error: true
#| 
if b5:
print('Inside')
print('Outside')
```

إذا قمت بزيادة المحاذاة لكل من جملتي `print()`، فسوف يعمل الكود بتدفِّقٍ غيرِ الذي قصدناه ابتداءً. أي أنه سيطبع `Outside` عندما يكون في الواقع داخل اللَّبِنَة الشرطية.

```{python}
if b5:
    print('Inside')
    print('Outside')
```

يؤدي الكود السابق إلى خطأ منطقي لن يظهر أبدًا كخطأ ولن يوقف البرنامج. لذا كن حذرًا مع المحاذاة في كتابة كود بايثون!

### تركيب الشروط

يمكنك دمج شروط متعددة باستخدام العوامل `and`، `or`، و `not`، لأنها تنتج قيمة منطقية (boolean value). على سبيل المثال:

```{python}
age = 20
height = 175

if age > 18 and height > 170:
  print("You are eligible to donate blood")
```

يمكننا استخدام الأقواس لتجميع الشروط معًا. كما أنها تزيل أي غموض في ترتيب العمليات:

```{python}
age = 16
temperature = 15
is_wearing_coat = True

if age < 16 or (temperature < 20 and not is_wearing_coat):
  print("I suggest you don't go outside")
```

يُنظَر للشرط بأكمله كقيمة منطقية واحدة تكون `True` أو `False` ولا بأس بتجزئته حينما يسهل بذلك الفهم:

```{python}
is_minor = age < 16
is_cold = temperature < 20
b = is_minor or (is_cold and not is_wearing_coat)

if b:
  print("I suggest you don't go outside")
```


### الجملة الشرطية المتكاملة

الصيغة المتكاملة للجملة الشرطية على النحو التالي:

```python
if <boolean expression>:
    <code>
elif <boolean expression>:
    <code>
else:
    <code>
```

قد يوجد [`elif`](https://docs.python.org/3/reference/compound_stmts.html#elif) واحدة أو أكثر، وقد توجد [`else`](https://docs.python.org/3/reference/compound_stmts.html#else) واحدة فقط. أما الكلمة `elif` فهي اختصار لـ `else if`. تسلسل `if` ... `elif` ... `elif` ... هو بديل لجمل `switch` أو `case` الموجودة في لغات أخرى.

جرب الكود التالي بقيم مختلفة لـ `x` وحاول تتبع تدفق التحكم:

- `x = -5`
- `x = 0`
- `x = 1`
- `x = 5`

```{python}
x = -5

if x < 0:
    x = 0
    print('Negative changed to zero')
elif x == 0:
    print('Zero')
elif x == 1:
    print('Single')
else:
    print('More')

print("Always:", x)
```

وهذا تصوير لسير الأوامر لنفس الكود. ملاحظة: اضغط على الزر `Prev` أو `Next` للتنقل بين خطوات التنفيذ الفعلية:

<iframe width="800" height="500" frameborder="0" src="https://pythontutor.com/iframe-embed.html#code=x%20%3D%20-5%0A%0Aif%20x%20%3C%200%3A%0A%20%20%20%20x%20%3D%200%0A%20%20%20%20print%28'Negative%20changed%20to%20zero'%29%0Aelif%20x%20%3D%3D%200%3A%0A%20%20%20%20print%28'Zero'%29%0Aelif%20x%20%3D%3D%201%3A%0A%20%20%20%20print%28'Single'%29%0Aelse%3A%0A%20%20%20%20print%28'More'%29%0A%0Aprint%28%22Always%3A%22,%20x%29&codeDivHeight=400&codeDivWidth=350&cumulative=false&curInstr=5&heapPrimitives=nevernest&origin=opt-frontend.js&py=3&rawInputLstJSON=%5B%5D&textReferences=false"> </iframe>

لاحظ أن العبارة الأخيرة خارج كل اللَّبِنات الشرطية لذا يتم تنفيذها دائمًا.

### تضمين الجمل الشرطية

جمل الشرط المضمنة هي جمل `if` داخل جمل `if` أخرى. على سبيل المثال:

```python
if <boolean expression>:
    if <boolean expression>:
        <code>
    else:
        <code>
else:
    <code>
```

لاحظ أيضًا أن المحاذاة مهمة. يجب أن تكون جملة `if` الداخلية ذات محاذاة أكثر من جملة `if` الخارجية.

#### مثال

افترض أننا نريد تعيين درجة لطالب بناءً على نتيجته، وفقًا للجدول التالي:

| Mark | Grade |
|---|---|
| 95-100 | A+ |
| 90-94  | A  |
| 85-89  | B+ |
| 80-84  | B  |
| 70-79  | C  |
| 60-69 | D |
| 0-59 | F |

```{python}
score = 95

if score >= 90:
  if score >= 95:
    print("Outstanding: A+")
  else:
    print("Excellent: A")

elif score >= 80:
  if score >= 85:
    print("Very Good: B+") 
  else:
    print("Good: B")

elif score >= 70:
  print("Okay: C")

elif score >= 60:
  print("Poor: D")

else:
  print("Failed: F")
```

وهذا تصوير له:

<iframe width="800" height="500" frameborder="0" src="https://pythontutor.com/iframe-embed.html#code=score%20%3D%2095%0A%0Aif%20score%20%3E%3D%2090%3A%0A%20%20if%20score%20%3E%3D%2095%3A%0A%20%20%20%20print%28%22Outstanding%3A%20A%2B%22%29%0A%20%20else%3A%0A%20%20%20%20print%28%22Excellent%3A%20A%22%29%0A%0Aelif%20score%20%3E%3D%2080%3A%0A%20%20if%20score%20%3E%3D%2085%3A%0A%20%20%20%20print%28%22Very%20Good%3A%20B%2B%22%29%20%0A%20%20else%3A%0A%20%20%20%20print%28%22Good%3A%20B%22%29%0A%0Aelif%20score%20%3E%3D%2070%3A%0A%20%20print%28%22Okay%3A%20C%22%29%0A%0Aelif%20score%20%3E%3D%2060%3A%0A%20%20print%28%22Poor%3A%20D%22%29%0A%0Aelse%3A%0A%20%20print%28%22Failed%3A%20F%22%29&codeDivHeight=400&codeDivWidth=350&cumulative=false&curInstr=0&heapPrimitives=nevernest&origin=opt-frontend.js&py=3&rawInputLstJSON=%5B%5D&textReferences=false"> </iframe>